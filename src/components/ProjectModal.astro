---
const { github } = Astro.props;
import { marked } from 'marked';

const response = await fetch(`https://raw.githubusercontent.com/jack-kraus/${github}/refs/heads/main/README.md`);
const markdown = await response.text();
const content = marked.parse(markdown);
---

<div class="fixed h-screen w-screen z-50 flex justify-center align-middle left-0 top-0 bg-black p-10">
    <div class="modal w-full h-full rounded-lg flex flex-col">
        <button class="self-end text-4xl" id="modal-button">&times;</button>
        <article class="p-10 overflow-scroll bg-zinc-900 rounded-md" id="article-modal">
            <div set:html={content}/>
        </article>
    </div>
</div>

<style is:global>
    article {
        background-image: linear-gradient(black 0%,rgba(0, 0, 0, 0) 2%, rgba(0, 0, 0, 0) 98%, black 100%);
        transition: background-image;
    }

    article.top {
        background-image: linear-gradient(rgba(0, 0, 0, 0) 98%, black 100%);
    }

    article.bottom {
        background-image: linear-gradient(black 0%,rgba(0, 0, 0, 0) 2%);
    }


    article img {
        max-width: 1000px;
    }

    * {
        color: white;
    }

    article ul {
        list-style-type: disc;
        list-style-position: inside;
    }

    .modal {
        max-width: 1000px;
    }

    article img {
        display: inline;
    }

    article a {
        color: #7a6ae3
    }
    article a:hover {
        color: #cb70f5;
        text-decoration: underline;
    }
    article a:active {
        color: white;
    }

    article a:hover {
        text-decoration: underline;
    }
    
    article h1 {
        font-size: 3rem;
        font-weight: 700;
        margin-top: 1.5rem;
    }
    article h2 {
        font-size: 2.5rem;
        font-weight: 500;
        margin-top: 1.25rem;
    }
    article h3 {
        font-size: 2rem;
        font-weight: 400;
        margin-top: 1rem;
    }
    article h4 {
        font-size: 1.5rem;
        font-weight: 300;
        margin-top: 0.75rem;
    }

    article strong {
        font-weight: 500;
        font-size: 1rem;
    }
    article p, article li {
        font-size: 1rem;
        font-weight: 300;
    }

    article p[align=center] img {
        border-radius: 10px;
        margin-top: 1.5rem;
        margin-bottom: 1.5rem;

        filter: drop-shadow(0 4px 4px rgba(0, 0, 0, 0.467));
    }

    article p[align=center] img:first-child {
        width: 100%;
        max-width: 600px;
    }

    article p[align=center] img:not(:first-child) {
        margin-top: 0;
    }
</style>

<script>
    const element = document.getElementById("article-modal");
    
    function currentScrollPercentage()
	{
        if (!element) return 0;
		return element.scrollTop / (element.scrollHeight - element.clientHeight);
	}

    if (element) {
        element.addEventListener("scroll", () => {
            const percent = currentScrollPercentage();
            console.log(percent);
            if (percent < 0.01) $(element).addClass("top").removeClass("bottom");
            else if (percent > 0.99) $(element).addClass("bottom").removeClass("top");
            else $(element).removeClass("bottom").removeClass("top");
        });

        $("#modal-button").on("click", () => {
            $(element).parent().parent().hide();
        });
    }

    
</script>